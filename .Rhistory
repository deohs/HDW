data$identifier_records <- replace(data$identifier_records, data$identifier_records=="106", "HDW-D04-S208")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="108", "HDW-D02-S210")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="109", "HDW-D05-S211")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="110", "HDW-D05-S210")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="24", "HDW-C02-S103")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="30", "HDW-D02-S17")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="32", "HDW-D02-S200")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="41", "HDW-D01-S201")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="50", "HDW-D03-S32")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="76", "HDW-C02-S131")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="77", "HDW-C02-S130")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="79", "HDW-C02-S112")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="81", "HDW-D02-S200")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="83", "HDW-C02-S114")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="85", "HDW-C02-S136")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="87", "HDW-C02-S134")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="88", "HDW-C02-S139")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="92", "HDW-C02-S143")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="94", "HDW-C02-S141")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="95", "HDW-C02-S143")
#data$identifier_records <- replace(data$identifier_records, data$identifier_records=="96", "") # NO DATA REMOVE FROM DATA SET
#data$identifier_records <- replace(data$identifier_records, data$identifier_records=="97", "") # NO DATA REMOVE FROM DATA SET
#data$identifier_records <- replace(data$identifier_records, data$identifier_records=="98", "") # NO DATA REMOVE FROM DATA SET
#data$identifier_records <- replace(data$identifier_records, data$identifier_records=="99", "") # NO DATA REMOVE FROM DATA SET
# Rename identifier_records to be identifier
data$identifier <- data$identifier_records
# Delete intermediate variables not of use: identifier_records and variables that are incomplete (id_number, id_number_v2, id_number_v3, record_id, record_id_v3)
#data <- data %>% select(-c(identifier_records, id_number, id_number_v2, id_number_v3, record_id, record_id_v3))
# Fix FILL THIS IN WHEN DONE
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="212", "HDW-D05-S212")
data$fecal_id <- replace(data$fecal_id, data$fecal_id==" HDW-D05-S212", "HDW-D05-S212")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S210", "HDW-D05-S210")
data$eno_id <- replace(data$eno_id, data$eno_id=="HDW-D05", "HDW-D05-S210")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-D04-S211", "HDW-D05-S211")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="209", "HDW-D02-S209")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="209", "HDW-D02-S209")
data$eno_id <- replace(data$eno_id, data$eno_id=="209", "HDW-D02-S209")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S205", "HDW-D04-S205")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="S141", "HDW-C02-S141")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="Hdw-c02-s140", "HDW-C02-S140")
data$eno_id <- replace(data$eno_id, data$eno_id=="Hdw-c02-s140", "HDW-C02-S140")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="143", "HDW-C02-S143")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="Hdw-c02-s140", "HDW-C02-S140")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="Hdw-c02-s140", "HDW-C02-S140")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S317", "HDW-C02-S137")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S317", "HDW-C02-S137")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-C01-S137", "HDW-C02-S137")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-C02-s137", "HDW-C02-S137")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="139", "HDW-C02-S139")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="139", "HDW-C02-S139")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="134", "HDW-C01-S134")
data$eno_id <- replace(data$eno_id, data$eno_id=="134", "HDW-C01-S134")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="133", "HDW-C02-S133")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="133", "HDW-C02-S133")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-C02 -S133", "HDW-C02-S133")
data$eno_id <- replace(data$eno_id, data$eno_id=="HDW-C02-133", "HDW-C02-S133")
data$fecal_id <- replace(data$fecal_id, data$fecal_id=="HDW-C02-136", "HDW-C02-S136")
data$bp_id <- replace(data$bp_id, data$bp_id=="HDW-C01-S135", "HDW-C02-S135")
data$fecal_id <- replace(data$fecal_id, data$fecal_id=="HDW-C01-S135", "HDW-C02-S135")
data$serum_id <- replace(data$serum_id, data$serum_id=="HDW-C01-S135", "HDW-C02-S135")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-C01-S135", "HDW-C02-S135")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-C021-S135", "HDW-C02-S135")
data$eno_id <- replace(data$eno_id, data$eno_id=="HDW-C021-S135", "HDW-C02-S135")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-D05-S212", "HDW-D05-S212")
data$nasal_id<- replace(data$nasal_id, data$nasal_id=="XHDW-D01-S01", "HDW-D01-S01")
data$spiro_id<- replace(data$spiro_id, data$spiro_id=="HDW-C01-S01", "HDW-D01-S01")
data$nasal_id<- replace(data$nasal_id, data$nasal_id=="HDW-C01-S01", "HDW-D01-S01")
data$serum_id<- replace(data$serum_id, data$serum_id=="HDW-C01-S01", "HDW-D01-S01")
data$eno_id<- replace(data$eno_id, data$eno_id=="HDW-D01-S09", "HDW-D02-S09")
data$spiro_id<- replace(data$spiro_id, data$spiro_id=="HDW-D01-S09", "HDW-D02-S09")
data$serum_id<- replace(data$serum_id, data$serum_id=="HDW-D01-S09", "HDW-D02-S09")
data$bp_id<- replace(data$bp_id, data$bp_id=="HDW-D01-S09", "HDW-D02-S09")
data$nasal_id <- replace(data$nasal_id, data$nasal_id==" HDW-D02", "HDW-D02-S11")
data$serum_id <- replace(data$serum_id, data$serum_id=="HDW-C02-S139", "HDW-D05-S213")
data$eno_id <- replace(data$eno_id, data$eno_id==" HDW-D01-S13", "HDW-D02-S13")
data$nasal_id <- replace(data$nasal_id, data$nasal_id==" HDW-D01-S13", "HDW-D02-S13")
data$spiro_id <- replace(data$spiro_id, data$spiro_id==" HWD-D02-S07", "HDW-D02-S07")
data$fecal_id <- replace(data$fecal_id, data$fecal_id==" HDW-C01-102", "HDW-C01-S102")
data$bp_id <- replace(data$bp_id, data$bp_id==" HDW-C01-102", "HDW-C01-S102")
data$eno_id <- replace(data$eno_id, data$eno_id=="S111", "HDW-C02-S111")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="S111", "HDW-C02-S111")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="111", "HDW-C02-S111")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="111", "HDW-CO2-S111")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="108", "HDW-C02-S108")
data$bp_id <- replace(data$bp_id, data$bp_id=="HDW-CO2-S113", "HDW-C02-S113")
data$eno_id <- replace(data$eno_id, data$eno_id=="113", "HDW-C02-S113")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="113", "HDW-C02-S113")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="113", "HDW-C02-S113")
data$serum_id <- replace(data$serum_id, data$serum_id=="113", "HDW-C02-S113")
data$fecal_id <- replace(data$fecall_id, data$fecal_id=="113", "HDW-C02-S113")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="113", "HDW-C02-S113")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="113", "HDW-C02-S113")
data$bp_id <- replace(data$bp_id, data$bp_id=="113", "HDW-C02-S113")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="18", "HDW-D02-S18")
data$eno_id <- replace(data$eno_id, data$eno_id=="23", "HDW-D01-S23")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="23", "HDW-D01-S23")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="26", "HDW-D03-S26")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="32", "HDW-D03-S32")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="32", "HDW-D03-S32")
data$fecal_id <- replace(data$fecal_id, data$fecal_id==" HSW-D03-S34", "HDW-D03-S34")
data$fecal_id <- replace(data$fecal_id, data$fecal_id==" HSW-D03-S235", "HDW-D03-S235")
data$eno_id <- replace(data$eno_id, data$eno_id=="HDW-D0", "HDW-D03-S136")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-?03-S37", "HDW-D03-S37")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="131", "HDW-C02-S131")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="131", "HDW-C02-S131")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="143", "HDW-C02-S143")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S137", "HDW-C02-S137")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S137", "HDW-C02-S137")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S123", "HDW-C02-S123")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S123", "HDW-C02-S123")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S122", "HDW-C02-S122")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S122", "HDW-C02-S122")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S118", "HDW-C02-S118")
data$eno_id <- replace(data$eno_id, data$eno_id=="S118", "HDW-C02-S118")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="32", "HDW-D03-S32")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="HDW-D02-S09", "HDW-D02-S109")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="HDW-CO2-S111", "HDW-C02-S111")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="205", "HDW-D04-S205")
data$eno_id <- replace(data$eno_id, data$eno_id=="Hdw-c02-S140", "HDW-C02-S140")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-C02-S10", "HDW-C02-S130")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-D02", "HDW-D02_S11")
data$serum_id <- replace(data$serum_id, data$serum_id=="HDW-D02-S09", "HDW-D02-S109")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
data <- replace_with_na_all(data=data, condition=~.x == "Pablo") #changing all "Pablo" observations in id variables to be NA
# data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-D05-S212", "HDW-D05-S212")
# data$eno_id <- replace(data$eno_id, data$eno_id==" HDW-D05-S212", "HDW-D05-S212")
# data$fecal_id <- replace(data$fecal_id, data$fecal_id=="HDW-D05-S212", "HDW-D05-S212")
# data$serum_id <- replace(data$serum_id, data$serum_id=="S213", "HDW-D05-S213")
# data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
# data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-D05-S212", "HDW-D05-S212")
# data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="212", "HDW-D05-S212")
# Data checks for specimens collected and the corresponding identifiers
# ids<- c("redcap_event_name", "identifier", "RedCap_id", "eno_id", "spiro_id", "nasal_id", "nasal_sample_id", "serum_id", "serum_sample_id", "fecal_id", "bp_id")
#
# interest <- c("redcap_event_name", "identifier", "eno_id", "spiro_id", "nasal_id",
#              "nasal_sample_id", "serum_id", "serum_sample_id", "fecal_id", "bp_id", "eno_date","spiro_date",
#              "nasal_date", "nasal_transport_date","serum_date", "serum_transport_date", "fecal_date",
#              "eno_notes","spiro_notes", "nasal_notes", "serum_notes", "fecal_notes")
#
#
# temp <- data %>% select(all_of(ids))
# View(temp)
# Loop to determine which IDs do not match for samples collected that are attached to the record
for (obs in 1:length(data)) {
#eno_id check
ifelse(!is.na(data$eno_id[obs]) & data$identifier[obs] != data$eno_id[obs], print(paste(data$identifier[obs], "does not match", data$eno_id[obs], "for eno_id", sep=" ")), "match")
#spiro_id check
ifelse(!is.na(data$spiro_id[obs]) & data$identifier[obs] != data$spiro_id[obs], print(paste(data$identifier[obs], "does not match", data$spiro_id[obs], "for spiro_id", sep=" ")), "match")
#nasal_id check
ifelse(!is.na(data$nasal_id[obs]) & data$identifier[obs] != data$nasal_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_id[obs], "for nasal_id", sep=" ")), "match")
#serum_id check
ifelse(!is.na(data$serum_id[obs]) & data$identifier[obs] != data$serum_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_id[obs], "for serum_id", sep=" ")), "match")
#fecal_id check
ifelse(!is.na(data$fecal_id[obs]) & data$identifier[obs] != data$fecal_id[obs], print(paste(data$identifier[obs], "does not match", data$fecal_id[obs], "for fecal_id", sep=" ")), "match")
#nasal_sample_id check
ifelse(!is.na(data$nasal_sample_id[obs]) & data$identifier[obs] != data$nasal_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_sample_id[obs], "for nasal_sample_id", sep=" ")), "match")
#serum_sample_id check
ifelse(!is.na(data$serum_sample_id[obs]) & data$identifier[obs] != data$serum_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_sample_id[obs], "for serum_sample_id", sep=" ")), "match")
#bp_id check
ifelse(!is.na(data$bp_id[obs]) & data$identifier[obs] != data$bp_id[obs], print(paste(data$identifier[obs], "does not match", data$bp_id[obs], "for bp_id", sep=" ")), "match")
}
# Make variable that is 1-6 for visit number (use casewhen function)
hdw <- hdw %>% separate(redcap_event_name, c("visit","person_type"), sep = "_arm_")
# Clearing the environment
rm(list=ls())
# Installing and loading libraries and packages
if (!require(pacman)) install.packages('pacman', repos = 'https://cloud.r-project.org')
#REDCap generated code to add labels to all variables, make relevant variables factors, and assign levels
pacman::p_load(dplyr, tidyr, janitor, ggplot2, readr, tidyverse, lubridate, naniar, Hmisc)
# Reading in data and labels
data <- read.csv("Z:/unrestricted/Center Projects/Healthy Dairy Worker/Data and Analysis/Data/HealthyDairyWorkers_DATA_2022-10-12_1152.csv")
data <- as.data.frame(data)
labels <- read.csv("Z:/unrestricted/Center Projects/Healthy Dairy Worker/Data and Analysis/Data/HealthyDairyWorkers_DATA_LABELS_2022-10-10.csv")
# Change all "" to NA throughout entire dataframe
data <- replace_with_na_all(data=data, condition=~.x == "")
data <- as.data.frame(data)
# Delete empty observations from the dataset (record_id= 96 and check for others)
# Create new variable called "identifier" that contains the study id for all participants (combining "id_number", "id_number_v2", "id_number_v3)
data <- data %>% mutate(identifier = coalesce(id_number, id_number_v2, id_number_v3))
# Delete completely empty observations (record_id = 96 and 99)
data <- data %>% filter(record_id!=96 & record_id!=99)
# Fix values that were spelled incorrectly or did not have the full identifier string
data$identifier <- replace(data$identifier, data$identifier=="DHW-D01-S05", "HDW-D01-S05")
data$identifier <- replace(data$identifier, data$identifier=="HWD-D02-S07", "HDW-D02-S07")
data$identifier <- replace(data$identifier, data$identifier=="S123", "HDW-C02-S123") #NEED TO CHECK REDCAP FOR ALL BELOW make sure there aren't duplicates of the numbers elsewhere in the data
data$identifier <- replace(data$identifier, data$identifier=="23", "HDW-D01-S23")
data$identifier <- replace(data$identifier, data$identifier=="108", "HDW-C02-S108")
data$identifier <- replace(data$identifier, data$identifier=="111", "HDW-C02-S111")
data$identifier <- replace(data$identifier, data$identifier=="118", "HDW-C02-S118")
data$identifier <- replace(data$identifier, data$identifier=="113", "HDW-C02-S113")
data$identifier <- replace(data$identifier, data$identifier=="131", "HDW-C02-S131")
data$identifier <- replace(data$identifier, data$identifier=="133", "HDW-C02-S133")
data$identifier <- replace(data$identifier, data$identifier=="139", "HDW-C02-S139")
data$identifier <- replace(data$identifier, data$identifier=="143", "HDW-C02-S143") #THERE ARE TWO OF THESE AS DIFFERENT RECORD NUMBERS
# Filling in remaining missing identifier values by using record ID and RedCap to match them
# Create new variable called RedCap_identifier that contains the record id that RedCap assigns participants (combining "record_id" and "record_id_v3")
data$record_id <- as.character(data$record_id)
data <- data %>% mutate(RedCap_id = coalesce(record_id, record_id_v3))
data <- data %>% mutate(identifier_records = ifelse(is.na(data$identifier), data$RedCap_id, data$identifier))
# Matching RedCap_id with id_number versions from RedCap manually
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="103", "HDW-D04-S206")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="106", "HDW-D04-S208")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="108", "HDW-D02-S210")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="109", "HDW-D05-S211")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="110", "HDW-D05-S210")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="24", "HDW-C02-S103")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="30", "HDW-D02-S17")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="32", "HDW-D02-S200")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="41", "HDW-D01-S201")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="50", "HDW-D03-S32")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="76", "HDW-C02-S131")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="77", "HDW-C02-S130")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="79", "HDW-C02-S112")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="81", "HDW-D02-S200")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="83", "HDW-C02-S114")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="85", "HDW-C02-S136")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="87", "HDW-C02-S134")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="88", "HDW-C02-S139")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="92", "HDW-C02-S143")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="94", "HDW-C02-S141")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="95", "HDW-C02-S143")
#data$identifier_records <- replace(data$identifier_records, data$identifier_records=="96", "") # NO DATA REMOVE FROM DATA SET
#data$identifier_records <- replace(data$identifier_records, data$identifier_records=="97", "") # NO DATA REMOVE FROM DATA SET
#data$identifier_records <- replace(data$identifier_records, data$identifier_records=="98", "") # NO DATA REMOVE FROM DATA SET
#data$identifier_records <- replace(data$identifier_records, data$identifier_records=="99", "") # NO DATA REMOVE FROM DATA SET
# Rename identifier_records to be identifier
data$identifier <- data$identifier_records
# Delete intermediate variables not of use: identifier_records and variables that are incomplete (id_number, id_number_v2, id_number_v3, record_id, record_id_v3)
#data <- data %>% select(-c(identifier_records, id_number, id_number_v2, id_number_v3, record_id, record_id_v3))
# Fix FILL THIS IN WHEN DONE
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="212", "HDW-D05-S212")
data$fecal_id <- replace(data$fecal_id, data$fecal_id==" HDW-D05-S212", "HDW-D05-S212")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S210", "HDW-D05-S210")
data$eno_id <- replace(data$eno_id, data$eno_id=="HDW-D05", "HDW-D05-S210")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-D04-S211", "HDW-D05-S211")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="209", "HDW-D02-S209")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="209", "HDW-D02-S209")
data$eno_id <- replace(data$eno_id, data$eno_id=="209", "HDW-D02-S209")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S205", "HDW-D04-S205")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="S141", "HDW-C02-S141")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="Hdw-c02-s140", "HDW-C02-S140")
data$eno_id <- replace(data$eno_id, data$eno_id=="Hdw-c02-s140", "HDW-C02-S140")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="143", "HDW-C02-S143")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="Hdw-c02-s140", "HDW-C02-S140")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="Hdw-c02-s140", "HDW-C02-S140")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S317", "HDW-C02-S137")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S317", "HDW-C02-S137")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-C01-S137", "HDW-C02-S137")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-C02-s137", "HDW-C02-S137")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="139", "HDW-C02-S139")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="139", "HDW-C02-S139")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="134", "HDW-C01-S134")
data$eno_id <- replace(data$eno_id, data$eno_id=="134", "HDW-C01-S134")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="133", "HDW-C02-S133")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="133", "HDW-C02-S133")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-C02 -S133", "HDW-C02-S133")
data$eno_id <- replace(data$eno_id, data$eno_id=="HDW-C02-133", "HDW-C02-S133")
data$fecal_id <- replace(data$fecal_id, data$fecal_id=="HDW-C02-136", "HDW-C02-S136")
data$bp_id <- replace(data$bp_id, data$bp_id=="HDW-C01-S135", "HDW-C02-S135")
data$fecal_id <- replace(data$fecal_id, data$fecal_id=="HDW-C01-S135", "HDW-C02-S135")
data$serum_id <- replace(data$serum_id, data$serum_id=="HDW-C01-S135", "HDW-C02-S135")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-C01-S135", "HDW-C02-S135")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-C021-S135", "HDW-C02-S135")
data$eno_id <- replace(data$eno_id, data$eno_id=="HDW-C021-S135", "HDW-C02-S135")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-D05-S212", "HDW-D05-S212")
data$nasal_id<- replace(data$nasal_id, data$nasal_id=="XHDW-D01-S01", "HDW-D01-S01")
data$spiro_id<- replace(data$spiro_id, data$spiro_id=="HDW-C01-S01", "HDW-D01-S01")
data$nasal_id<- replace(data$nasal_id, data$nasal_id=="HDW-C01-S01", "HDW-D01-S01")
data$serum_id<- replace(data$serum_id, data$serum_id=="HDW-C01-S01", "HDW-D01-S01")
# data$eno_id<- replace(data$eno_id, data$eno_id=="HDW-D01-S09", "HDW-D02-S09")
# data$spiro_id<- replace(data$spiro_id, data$spiro_id=="HDW-D01-S09", "HDW-D02-S09")
# data$serum_id<- replace(data$serum_id, data$serum_id=="HDW-D01-S09", "HDW-D02-S09")
# data$bp_id<- replace(data$bp_id, data$bp_id=="HDW-D01-S09", "HDW-D02-S09")
data$nasal_id <- replace(data$nasal_id, data$nasal_id==" HDW-D02", "HDW-D02-S11")
data$serum_id <- replace(data$serum_id, data$serum_id=="HDW-C02-S139", "HDW-D05-S213")
data$eno_id <- replace(data$eno_id, data$eno_id==" HDW-D01-S13", "HDW-D02-S13")
data$nasal_id <- replace(data$nasal_id, data$nasal_id==" HDW-D01-S13", "HDW-D02-S13")
data$spiro_id <- replace(data$spiro_id, data$spiro_id==" HWD-D02-S07", "HDW-D02-S07")
data$fecal_id <- replace(data$fecal_id, data$fecal_id==" HDW-C01-102", "HDW-C01-S102")
data$bp_id <- replace(data$bp_id, data$bp_id==" HDW-C01-102", "HDW-C01-S102")
data$eno_id <- replace(data$eno_id, data$eno_id=="S111", "HDW-C02-S111")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="S111", "HDW-C02-S111")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="111", "HDW-C02-S111")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="111", "HDW-CO2-S111")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="108", "HDW-C02-S108")
data$bp_id <- replace(data$bp_id, data$bp_id=="HDW-CO2-S113", "HDW-C02-S113")
data$eno_id <- replace(data$eno_id, data$eno_id=="113", "HDW-C02-S113")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="113", "HDW-C02-S113")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="113", "HDW-C02-S113")
data$serum_id <- replace(data$serum_id, data$serum_id=="113", "HDW-C02-S113")
data$fecal_id <- replace(data$fecall_id, data$fecal_id=="113", "HDW-C02-S113")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="113", "HDW-C02-S113")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="113", "HDW-C02-S113")
data$bp_id <- replace(data$bp_id, data$bp_id=="113", "HDW-C02-S113")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="18", "HDW-D02-S18")
data$eno_id <- replace(data$eno_id, data$eno_id=="23", "HDW-D01-S23")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="23", "HDW-D01-S23")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="26", "HDW-D03-S26")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="32", "HDW-D03-S32")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="32", "HDW-D03-S32")
data$fecal_id <- replace(data$fecal_id, data$fecal_id==" HSW-D03-S34", "HDW-D03-S34")
data$fecal_id <- replace(data$fecal_id, data$fecal_id==" HSW-D03-S235", "HDW-D03-S235")
data$eno_id <- replace(data$eno_id, data$eno_id=="HDW-D0", "HDW-D03-S136")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-?03-S37", "HDW-D03-S37")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="131", "HDW-C02-S131")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="131", "HDW-C02-S131")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="143", "HDW-C02-S143")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S137", "HDW-C02-S137")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S137", "HDW-C02-S137")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S123", "HDW-C02-S123")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S123", "HDW-C02-S123")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S122", "HDW-C02-S122")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S122", "HDW-C02-S122")
data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="S118", "HDW-C02-S118")
data$eno_id <- replace(data$eno_id, data$eno_id=="S118", "HDW-C02-S118")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="32", "HDW-D03-S32")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
#data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="HDW-D02-S09", "HDW-D02-S109")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="HDW-CO2-S111", "HDW-C02-S111")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="205", "HDW-D04-S205")
data$eno_id <- replace(data$eno_id, data$eno_id=="Hdw-c02-S140", "HDW-C02-S140")
data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-C02-S10", "HDW-C02-S130")
data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-D02", "HDW-D02_S11")
#data$serum_id <- replace(data$serum_id, data$serum_id=="HDW-D02-S09", "HDW-D02-S109")
data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
data <- replace_with_na_all(data=data, condition=~.x == "Pablo") #changing all "Pablo" observations in id variables to be NA
# data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-D05-S212", "HDW-D05-S212")
# data$eno_id <- replace(data$eno_id, data$eno_id==" HDW-D05-S212", "HDW-D05-S212")
# data$fecal_id <- replace(data$fecal_id, data$fecal_id=="HDW-D05-S212", "HDW-D05-S212")
# data$serum_id <- replace(data$serum_id, data$serum_id=="S213", "HDW-D05-S213")
# data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
# data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-D05-S212", "HDW-D05-S212")
# data$nasal_sample_id <- replace(data$nasal_sample_id, data$nasal_sample_id=="212", "HDW-D05-S212")
# Data checks for specimens collected and the corresponding identifiers
# ids<- c("redcap_event_name", "identifier", "RedCap_id", "eno_id", "spiro_id", "nasal_id", "nasal_sample_id", "serum_id", "serum_sample_id", "fecal_id", "bp_id")
#
# interest <- c("redcap_event_name", "identifier", "eno_id", "spiro_id", "nasal_id",
#              "nasal_sample_id", "serum_id", "serum_sample_id", "fecal_id", "bp_id", "eno_date","spiro_date",
#              "nasal_date", "nasal_transport_date","serum_date", "serum_transport_date", "fecal_date",
#              "eno_notes","spiro_notes", "nasal_notes", "serum_notes", "fecal_notes")
#
#
# temp <- data %>% select(all_of(ids))
# View(temp)
# Loop to determine which IDs do not match for samples collected that are attached to the record
for (obs in 1:length(data)) {
#eno_id check
ifelse(!is.na(data$eno_id[obs]) & data$identifier[obs] != data$eno_id[obs], print(paste(data$identifier[obs], "does not match", data$eno_id[obs], "for eno_id", sep=" ")), "match")
#spiro_id check
ifelse(!is.na(data$spiro_id[obs]) & data$identifier[obs] != data$spiro_id[obs], print(paste(data$identifier[obs], "does not match", data$spiro_id[obs], "for spiro_id", sep=" ")), "match")
#nasal_id check
ifelse(!is.na(data$nasal_id[obs]) & data$identifier[obs] != data$nasal_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_id[obs], "for nasal_id", sep=" ")), "match")
#serum_id check
ifelse(!is.na(data$serum_id[obs]) & data$identifier[obs] != data$serum_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_id[obs], "for serum_id", sep=" ")), "match")
#fecal_id check
ifelse(!is.na(data$fecal_id[obs]) & data$identifier[obs] != data$fecal_id[obs], print(paste(data$identifier[obs], "does not match", data$fecal_id[obs], "for fecal_id", sep=" ")), "match")
#nasal_sample_id check
ifelse(!is.na(data$nasal_sample_id[obs]) & data$identifier[obs] != data$nasal_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_sample_id[obs], "for nasal_sample_id", sep=" ")), "match")
#serum_sample_id check
ifelse(!is.na(data$serum_sample_id[obs]) & data$identifier[obs] != data$serum_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_sample_id[obs], "for serum_sample_id", sep=" ")), "match")
#bp_id check
ifelse(!is.na(data$bp_id[obs]) & data$identifier[obs] != data$bp_id[obs], print(paste(data$identifier[obs], "does not match", data$bp_id[obs], "for bp_id", sep=" ")), "match")
}
# Make variable that is 1-6 for visit number (use casewhen function)
hdw <- hdw %>% separate(redcap_event_name, c("visit","person_type"), sep = "_arm_")
# Clearing the environment
rm(list=ls())
# Installing and loading libraries and packages
if (!require(pacman)) install.packages('pacman', repos = 'https://cloud.r-project.org')
#REDCap generated code to add labels to all variables, make relevant variables factors, and assign levels
pacman::p_load(dplyr, tidyr, janitor, ggplot2, readr, tidyverse, lubridate, naniar, Hmisc)
# Reading in data and labels
data <- read.csv("Z:/unrestricted/Center Projects/Healthy Dairy Worker/Data and Analysis/Data/HealthyDairyWorkers_DATA_2022-10-12_1152.csv")
data <- as.data.frame(data)
labels <- read.csv("Z:/unrestricted/Center Projects/Healthy Dairy Worker/Data and Analysis/Data/HealthyDairyWorkers_DATA_LABELS_2022-10-10.csv")
# Change all "" to NA throughout entire dataframe
data <- replace_with_na_all(data=data, condition=~.x == "")
data <- as.data.frame(data)
# Delete empty observations from the dataset (record_id= 96 and check for others)
# Create new variable called "identifier" that contains the study id for all participants (combining "id_number", "id_number_v2", "id_number_v3)
data <- data %>% mutate(identifier = coalesce(id_number, id_number_v2, id_number_v3))
# Delete completely empty observations (record_id = 96 and 99)
data <- data %>% filter(record_id!=96 & record_id!=99)
data$identifier <- replace(data$identifier, data$identifier=="DHW-D01-S05", "HDW-D01-S05")
data$identifier <- replace(data$identifier, data$identifier=="HWD-D02-S07", "HDW-D02-S07")
data$identifier <- replace(data$identifier, data$identifier=="S123", "HDW-C02-S123") #NEED TO CHECK REDCAP FOR ALL BELOW make sure there aren't duplicates of the numbers elsewhere in the data
data$identifier <- replace(data$identifier, data$identifier=="23", "HDW-D01-S23")
data$identifier <- replace(data$identifier, data$identifier=="108", "HDW-C02-S108")
data$identifier <- replace(data$identifier, data$identifier=="111", "HDW-C02-S111")
data$identifier <- replace(data$identifier, data$identifier=="118", "HDW-C02-S118")
data$identifier <- replace(data$identifier, data$identifier=="113", "HDW-C02-S113")
data$identifier <- replace(data$identifier, data$identifier=="131", "HDW-C02-S131")
data$identifier <- replace(data$identifier, data$identifier=="133", "HDW-C02-S133")
data$identifier <- replace(data$identifier, data$identifier=="139", "HDW-C02-S139")
data$identifier <- replace(data$identifier, data$identifier=="143", "HDW-C02-S143") #THERE ARE TWO OF THESE AS DIFFERENT RECORD NUMBERS
data$record_id <- as.character(data$record_id)
data <- data %>% mutate(RedCap_id = coalesce(record_id, record_id_v3))
data <- data %>% mutate(identifier_records = ifelse(is.na(data$identifier), data$RedCap_id, data$identifier))
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="103", "HDW-D04-S206")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="106", "HDW-D04-S208")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="108", "HDW-D02-S210")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="109", "HDW-D05-S211")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="110", "HDW-D05-S210")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="24", "HDW-C02-S103")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="30", "HDW-D02-S17")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="32", "HDW-D02-S200")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="41", "HDW-D01-S201")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="50", "HDW-D03-S32")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="76", "HDW-C02-S131")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="77", "HDW-C02-S130")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="79", "HDW-C02-S112")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="81", "HDW-D02-S200")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="83", "HDW-C02-S114")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="85", "HDW-C02-S136")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="87", "HDW-C02-S134")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="88", "HDW-C02-S139")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="92", "HDW-C02-S143")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="94", "HDW-C02-S141")
data$identifier_records <- replace(data$identifier_records, data$identifier_records=="95", "HDW-C02-S143")
#data
# Rename identifier_records to be identifier
data$identifier <- data$identifier_records
# Data checks for specimens collected and the corresponding identifiers
# ids<- c("redcap_event_name", "identifier", "RedCap_id", "eno_id", "spiro_id", "nasal_id", "nasal_sample_id", "serum_id", "serum_sample_id", "fecal_id", "bp_id")
#
# interest <- c("redcap_event_name", "identifier", "eno_id", "spiro_id", "nasal_id",
#              "nasal_sample_id", "serum_id", "serum_sample_id", "fecal_id", "bp_id", "eno_date","spiro_date",
#              "nasal_date", "nasal_transport_date","serum_date", "serum_transport_date", "fecal_date",
#              "eno_notes","spiro_notes", "nasal_notes", "serum_notes", "fecal_notes")
#
#
# temp <- data %>% select(all_of(ids))
# View(temp)
# Loop to determine which IDs do not match for samples collected that are attached to the record
for (obs in 1:length(data)) {
#eno_id check
ifelse(!is.na(data$eno_id[obs]) & data$identifier[obs] != data$eno_id[obs], print(paste(data$identifier[obs], "does not match", data$eno_id[obs], "for eno_id", sep=" ")), "match")
#spiro_id check
ifelse(!is.na(data$spiro_id[obs]) & data$identifier[obs] != data$spiro_id[obs], print(paste(data$identifier[obs], "does not match", data$spiro_id[obs], "for spiro_id", sep=" ")), "match")
#nasal_id check
ifelse(!is.na(data$nasal_id[obs]) & data$identifier[obs] != data$nasal_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_id[obs], "for nasal_id", sep=" ")), "match")
#serum_id check
ifelse(!is.na(data$serum_id[obs]) & data$identifier[obs] != data$serum_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_id[obs], "for serum_id", sep=" ")), "match")
#fecal_id check
ifelse(!is.na(data$fecal_id[obs]) & data$identifier[obs] != data$fecal_id[obs], print(paste(data$identifier[obs], "does not match", data$fecal_id[obs], "for fecal_id", sep=" ")), "match")
#nasal_sample_id check
ifelse(!is.na(data$nasal_sample_id[obs]) & data$identifier[obs] != data$nasal_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_sample_id[obs], "for nasal_sample_id", sep=" ")), "match")
#serum_sample_id check
ifelse(!is.na(data$serum_sample_id[obs]) & data$identifier[obs] != data$serum_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_sample_id[obs], "for serum_sample_id", sep=" ")), "match")
#bp_id check
ifelse(!is.na(data$bp_id[obs]) & data$identifier[obs] != data$bp_id[obs], print(paste(data$identifier[obs], "does not match", data$bp_id[obs], "for bp_id", sep=" ")), "match")
}
# data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
# #data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="HDW-D02-S09", "HDW-D02-S109")
# data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="HDW-CO2-S111", "HDW-C02-S111")
# data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="205", "HDW-D04-S205")
# data$eno_id <- replace(data$eno_id, data$eno_id=="Hdw-c02-S140", "HDW-C02-S140")
# data$spiro_id <- replace(data$spiro_id, data$spiro_id=="HDW-C02-S10", "HDW-C02-S130")
# data$nasal_id <- replace(data$nasal_id, data$nasal_id=="HDW-D02", "HDW-D02_S11")
# #data$serum_id <- replace(data$serum_id, data$serum_id=="HDW-D02-S09", "HDW-D02-S109")
# data$serum_sample_id <- replace(data$serum_sample_id, data$serum_sample_id=="S213", "HDW-D05-S213")
#
data <- replace_with_na_all(data=data, condition=~.x == "Pablo") #changing all "Pablo" observations in id variables to be NA
for (obs in 1:length(data)) {
#eno_id check
ifelse(!is.na(data$eno_id[obs]) & data$identifier[obs] != data$eno_id[obs], print(paste(data$identifier[obs], "does not match", data$eno_id[obs], "for eno_id", sep=" ")), "match")
#spiro_id check
ifelse(!is.na(data$spiro_id[obs]) & data$identifier[obs] != data$spiro_id[obs], print(paste(data$identifier[obs], "does not match", data$spiro_id[obs], "for spiro_id", sep=" ")), "match")
#nasal_id check
ifelse(!is.na(data$nasal_id[obs]) & data$identifier[obs] != data$nasal_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_id[obs], "for nasal_id", sep=" ")), "match")
#serum_id check
ifelse(!is.na(data$serum_id[obs]) & data$identifier[obs] != data$serum_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_id[obs], "for serum_id", sep=" ")), "match")
#fecal_id check
ifelse(!is.na(data$fecal_id[obs]) & data$identifier[obs] != data$fecal_id[obs], print(paste(data$identifier[obs], "does not match", data$fecal_id[obs], "for fecal_id", sep=" ")), "match")
#nasal_sample_id check
ifelse(!is.na(data$nasal_sample_id[obs]) & data$identifier[obs] != data$nasal_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_sample_id[obs], "for nasal_sample_id", sep=" ")), "match")
#serum_sample_id check
ifelse(!is.na(data$serum_sample_id[obs]) & data$identifier[obs] != data$serum_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_sample_id[obs], "for serum_sample_id", sep=" ")), "match")
#bp_id check
ifelse(!is.na(data$bp_id[obs]) & data$identifier[obs] != data$bp_id[obs], print(paste(data$identifier[obs], "does not match", data$bp_id[obs], "for bp_id", sep=" ")), "match")
}
data$nasal_id<- replace(data$nasal_id, data$nasal_id=="XHDW-D01-S01", "HDW-D01-S01")
data$spiro_id<- replace(data$spiro_id, data$spiro_id=="HDW-C01-S01", "HDW-D01-S01")
data$nasal_id<- replace(data$nasal_id, data$nasal_id=="HDW-C01-S01", "HDW-D01-S01")
data$serum_id<- replace(data$serum_id, data$serum_id=="HDW-C01-S01", "HDW-D01-S01")
data$eno_id<- replace(data$eno_id, data$eno_id=="HDW-D01-S09", "HDW-D02-S09")
data$spiro_id<- replace(data$spiro_id, data$spiro_id=="HDW-D01-S09", "HDW-D02-S09")
data$serum_id<- replace(data$serum_id, data$serum_id=="HDW-D01-S09", "HDW-D02-S09")
data$bp_id<- replace(data$bp_id, data$bp_id=="HDW-D01-S09", "HDW-D02-S09")
for (obs in 1:length(data)) {
#eno_id check
ifelse(!is.na(data$eno_id[obs]) & data$identifier[obs] != data$eno_id[obs], print(paste(data$identifier[obs], "does not match", data$eno_id[obs], "for eno_id", sep=" ")), "match")
#spiro_id check
ifelse(!is.na(data$spiro_id[obs]) & data$identifier[obs] != data$spiro_id[obs], print(paste(data$identifier[obs], "does not match", data$spiro_id[obs], "for spiro_id", sep=" ")), "match")
#nasal_id check
ifelse(!is.na(data$nasal_id[obs]) & data$identifier[obs] != data$nasal_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_id[obs], "for nasal_id", sep=" ")), "match")
#serum_id check
ifelse(!is.na(data$serum_id[obs]) & data$identifier[obs] != data$serum_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_id[obs], "for serum_id", sep=" ")), "match")
#fecal_id check
ifelse(!is.na(data$fecal_id[obs]) & data$identifier[obs] != data$fecal_id[obs], print(paste(data$identifier[obs], "does not match", data$fecal_id[obs], "for fecal_id", sep=" ")), "match")
#nasal_sample_id check
ifelse(!is.na(data$nasal_sample_id[obs]) & data$identifier[obs] != data$nasal_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$nasal_sample_id[obs], "for nasal_sample_id", sep=" ")), "match")
#serum_sample_id check
ifelse(!is.na(data$serum_sample_id[obs]) & data$identifier[obs] != data$serum_sample_id[obs], print(paste(data$identifier[obs], "does not match", data$serum_sample_id[obs], "for serum_sample_id", sep=" ")), "match")
#bp_id check
ifelse(!is.na(data$bp_id[obs]) & data$identifier[obs] != data$bp_id[obs], print(paste(data$identifier[obs], "does not match", data$bp_id[obs], "for bp_id", sep=" ")), "match")
}
